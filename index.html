<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Coterie</title>
		<!--[if lt IE 9]>
		<script type='text/javascript' src='./lib/js/html5.js'></script>
		<style>.gainlayout { min-width: 0; }</style>
		<![endif]-->
		<!--[if (IE 6)|(IE 8)]>
		<script>window.MooToolsCoreVersion = '1.4.2';</script>
		<![endif]-->
		<!--[if lte IE 6]>
		<style>.gainlayout { height: 1px; }</style>
		<![endif]-->
		<link rel='stylesheet/css' href='./lib/css/normalize.css' type='text/css' media='screen' charset='utf-8' />
		<style type='text/css'>
			html, body {
				background-color: #CCCCCC;
				height: 100%;
				margin: 0;
				padding: 0;
			}
			/*
			* {
				-webkit-box-shadow: 0 0 1px red;
			}
			*/
			#outer, #outer div {
				margin: 8px;
				padding: 8px;
			}
			#pageConsole {
				background-color: #F5F5F5;
				height: 10em;
				opacity: 0;
				overflow-y: auto;
				visibility: hidden;
			}
			#pageFooter, #pageHeader, #pageMain {
				padding: 0 40px;
			}
			#pageMainContent {
				background-color: #EAEAEA;
				margin-bottom: 16px;
			}
			#pageModal {
				background-color: #0D3349;
				height: 100%;
				left: 0;
				opacity: 0;
				position: fixed;
				top: 0;
				visibility: hidden;
				width: 100%;
				z-index: 100;
			}
			.modal
			{
			    background-color: #0D3349;
			    height: 100%;
			    left: -100%;
			    position: fixed;
			    top: 0; 
			    width: 100%;
			    z-index: 150;
			}
			.modal-tbody, .modal-tr, .modal-td
			{
			    height: 100%; /* All table elements should be height 100% */
			}
			.modal-td
			{
			    vertical-align: middle;
			}
			.modal-box
			{
			    background-color: #eaeaea;
			    border: 1px solid;
			    border-radius: 25px;
			    height: auto;
			    left: 100%;
			    margin: 0 auto;
			    /*
			    max-height: 80%;
			    max-width: 90%;
			    min-height: 80px;
			    min-width: 80px;
			    */
			 	opacity: 0;
			    position: relative;
			    top: 200px; /* start from "hidden" position */
			    visibility: hidden; /* start hidden */
			    width: 800px;				
			}
			.modal-content
			{
			    overflow: auto;
			}
			.modal-content::-webkit-scrollbar {
				background-color: rgba(0,0,0,0.1);
			    width: 8px;
			}
			.modal-content::-webkit-scrollbar-track {
			    -webkit-box-shadow: inset 0 0 4px 1px rgba(0,0,0,0.3);
			    border-radius: 10px;
			}
			.modal-content::-webkit-scrollbar-thumb {
			    border-radius: 10px;
			    -webkit-box-shadow: inset 0 0 4px 1px rgba(0,0,0,0.5);
			}
			.modal-body {
				margin: 32px auto;
				text-align: center;
			}
			.modal-body img {
				border-radius: 10px;
			}
		</style>
		<script type='text/javascript' src='./lib/js/less-1.2.0.min.js'></script>
		<script type='text/javascript' src='./lib/js/require.js'></script>
		<script type='text/javascript'>
			(function(){
				var MooToolsCoreVersion = window.MooToolsCoreVersion || '1.4.3', required = {
					substitutions: {
						base: './lib/js/'
					},
					library: [
						['{base}mootools-core-' + MooToolsCoreVersion + '-full-nocompat-yc.js'],
						['{base}mootools-more-1.4.0.1-smoothscroll-uri-nocompat-yc.js',
							'{base}Company.js',
							'{base}mootools.history.js'],
						['{base}powertools-1.1.0-singleton.js',
							'{base}debugUnit.js', 
							'{base}stacktrace-min-0.3.js'],
						['{base}order!{base}mootools-more-1.4.0.1-table-nocompat.js',
							'{base}order!{base}Element.Data.js',
							'{base}order!{base}BehaviorAPI.js',
							'{base}order!{base}Behavior.js',
							//'{base}order!{base}Event.Mock.js',
							//'{base}order!{base}Delegator.js',
							//'{base}order!{base}Behavior.Startup.js',
							'{base}domReady!']
					]
				};
				required.library = required.library.map(function(list){
					return list.map(function(item){
						for (var substitution in this.substitutions){
							if (substitution !== undefined) {
								item = item.replace(new RegExp('{' + substitution + '}', 'g'), this.substitutions[substitution]);
							}
						}
						return item;
					}, required);
				}, required);
				require(required.library[0], function() {
					require(required.library[1], function() {
						this.debugSettings = {
							enabled: true,
							logToElement: {
								enabled: true,
								id: 'pageConsole',
								visible: true
							},
							verbose: false
						};
						require(required.library[2], function() {
							var utilityUnit = new Unit({
								initSetup: function(){
									// reposition the browser to match parent or fall back to upper left
									window.resizeTo(window.screen.availWidth, window.screen.availHeight);
									var winPos = window.parent.getPosition();
									window.moveTo(winPos.x, winPos.y);
								},
								readySetup: function(){
									this.publish('!console.log', ["%c%s%c dom is ready", 'font-weight: bold;', (new Date()).toLocaleTimeString(), 'font-weight: normal;']);
								}
							});
							var historyUnit = new Unit({
								initSetup: function(){
									this.winFx = new Fx.Scroll(window);
									History.replaceState({state: 0}, document.title + ': Welcome', '?state=0;');
									this.subscribe('switchboard.reroute', this.storeAnchor);
									window.addEvents({
										'statechange': this.statechange.bind(this)
									});
								},
								scrollPage: function(href){
									var bookmark = document.id(href);
									this.winFx.toElement(bookmark); 
									this.publish('!console.log', ["%c%s%c scrolling to: %s", 'font-weight: bold;', (new Date()).toLocaleTimeString(), 'font-weight: normal;', bookmark.get('id')]);
									return;
								},
								statechange: function(){
									var state = History.getState();
									if (state.data.type == 'bookmark'){
										this.scrollPage(state.data.anchor);
									} else if (window.getScroll().y !== 0){
										this.winFx.toTop();
										this.publish('!console.log', ["%c%s%c scrolling to top of window", 'font-weight: bold;', (new Date()).toLocaleTimeString(), 'font-weight: normal;']);
									}
									this.publish('!console.log', ["%c%s%c state: %s - statechange: %s", 'font-weight: bold;', (new Date()).toLocaleTimeString(), 'font-weight: normal;', state.data.state, state.title]);
								},
								storeAnchor: function(anchorMessage){
									var anchor = anchorMessage.anchor,
										name = anchorMessage.name,
										type = anchorMessage.type,
										state = History.getState().data.state + 1,
										title;
									pageState = state;
									switch (type){
										case 'ajax':
											title = document.title.split(':')[0] + ': ' + name;
											break;
										case 'bookmark':
											title = document.title.split(' (')[0] + ' (' + name + ')';
											break;
										default:
											title = document.title.split(':')[0];
									}
									History.pushState({'anchor': anchor, 'name': name, 'state': state, 'type': type}, title, "?anchor=" + anchor + ";state=" + state + ";type=" + type + ';');
									this.publish('!console.log', ["%c%s%c state: %s - window.location: %s", 'font-weight: bold;', (new Date()).toLocaleTimeString(), 'font-weight: normal;', state, window.location]);
								}
							});
							var switchBoardUnit = new Unit({
								Prefix: 'switchboard',
								initSetup: function(){
									this.subscribe('switchboard.route', this.route);
								},
								route: function(sbuObj){
									var href = sbuObj.href,
										text = sbuObj.text;
									if (href.test('^.*#$')){
										this.publish('reroute', {anchor: href.slice(0, -1), name: text, type: 'ajax'});
									} else if (href.test('^.*#.+$')) {
										if (href.test('^.*#!.*$')) {
											this.publish('!modal.conjure', 'summon');
										} else {
											this.publish('reroute', {anchor: href.split('#')[1], name: text, type: 'bookmark'});
										}
									} else if (href.test('^[^#]+$')) {
										this.publish('reroute', {anchor: href, name: text, type: 'ajax'});
									} else {
										// noop -- yet
									}
								}
							});
							require(required.library[3], function() {
								if (Browser.ie) {
									window.fireEvent('domready');
								}
								Behavior.addGlobalFilters({
									'Anchors': function(element){
										var anchorUnit = new Unit({
											readySetup: function(){
												element.addEvent('click:relay(a)', function(event, element){
													event.stop();
													if (element){
														var href=element.get('href'),
															text=element.get('text');
														this.publish('!switchboard.route', {href: href, text: text});
													}
												}.bind(this));
											}
										});
									},
									'Console': function(element, api){
										if (api.get('open')){
											element.fade('in');
										} else {
											element.fade('out');
										}
										new Unit({
											readySetup: function(){
												this.element = element;
												this.scrollLock = false;
												this.lastScrollY = this.element.getScroll().y;
												this.element.addEvent('scroll', function(event, target){
													if (!this.scrollLock && this.element.getScroll().y < this.lastScrollY){
														this.scrollLock = true;
													} else if (this.scrollLock && this.element.getScrollSize().y - this.element.getSize().y == this.element.getScroll().y){
														this.scrollLock = false;
													}
													this.lastScrollY = this.element.getScroll().y;
												}.bind(this));
												this.consoleScroller = new Fx.Scroll(this.element, {
													duration: 50,
													fps: 50,
													link: 'chain',
													transition: 'linear'
												});
												this.subscribe('!console.log', this.scroll)
											},
											scroll: function(){
												if (!this.scrollLock){
													this.consoleScroller.toBottom();
												}
											}
										});
									},
									'Copyright': function(element){
										var copyrightYearElement = element.getElement('.copyrightYear');
										if (copyrightYearElement) {
											var currentYear = (new Date()).getFullYear();
											if (Number.from(copyrightYearElement.get('text')) < currentYear) {
												copyrightYearElement.appendText('-' + currentYear);
											}
										}
										return copyrightYearElement;
									},
									'Modal': function(element, api){
										var headerFooterMargin = api.get('margin');
										var modalUnit = new Unit({
											conjure: function(invocation){
												switch (invocation) {
													case 'summon':
														document.addEvent('keydown', function(event){
														    if (event.key == 'esc'){
														    	this.publish('modal.conjure', 'dismiss');
														    }
														}.bind(this));
														if (Browser.ie6) {
															this.element.setStyles({
																'display': 'block',
																'height': window.getSize().y
															});
														}
														this.element.getElement('.modal-box').morph({
															opacity: [0, 1],
															top: [200, 0],
															visibility: ['hidden', 'visible']
														});
														this.shim.fade(0.5);
														break;
													case 'dismiss':
														document.removeEvents('keydown');
														var boxMorph = new Fx.Morph(this.element.getElement('.modal-box'), {
															onComplete: function(){
																if (Browser.ie6){
																	this.element.setStyle('display', 'none');
																}
															}.bind(this)
														});
														boxMorph.start({
															opacity: 0,
															top: 200
														});
														this.shim.fade('out');
														break;
													default:
												}
											},
											readySetup: function(){
												this.element = element;
												this.shim = document.id(this.element).getPrevious('div');
												//this.shim.fade('hide');
												//this.element.fade('hide');
												if (Browser.ie6){
													this.element.setStyles({
														'display': 'none',
														'position': 'absolute'
													});
													this.element.getElement('.modal-box').setStyles({
														'opacity': 0
													});
													this.element.getElement('.pageModal').setStyles({
														'opacity': 0,
														'position': 'absolute'
													});
													window.addEvent('scroll', function(){
														this.element.setStyle('top', window.getScroll().y);
													}.bind(this));
												}
												window.addEvent('resize', function(event){
													var maxHeight = document.documentElement.offsetHeight - headerFooterMargin;
													this.element.getElement('.modal-content').setStyle('max-height', maxHeight);
													return false;
												}.bind(this));
												this.element.addEvent('dblclick', this.conjure.bind(this, 'dismiss'));
												this.shim.addEvent('click', this.conjure.bind(this, 'dismiss'));
												this.subscribe('modal.conjure', this.conjure);
												// test
												//(function(){this.publish('modal.conjure', 'summon')}).delay(2000, this);
											}
										});
									},
									'TwoPanelAJAX': function(element, api){
										var articleUnit = new Unit({
											loadPage: function(anchorMessage){
												if (anchorMessage.type != 'ajax'){
													return false;
												}
												this.article.set('load', {
													evalScripts: false,
													method: 'get',
													noCache: Browser.ie,
													onFailure: function(responseXHR){
														if (responseXHR.status === 0){
															var match = responseXHR.responseText.match(/<body[^>]*>([\s\S]*?)<\/body>/i);
															if (match) {
																this.article.set('html', match[1]);
															}
														} else {
															// error message
														}
													}.bind(this)
												});												
												this.article.load(anchorMessage.anchor);
											},
											readySetup: function(){
												this.article = element.getFirst('article');
												this.subscribe('switchboard.reroute', this.loadPage);
											}
										});
										var referenceUnit = new Unit({
											readySetup: function(){
												this.reference = element.getLast('article');
											}
										});
									}
								});
								var pageBehavior = new Behavior().apply(document.body);
							});
						});
					});
				});
			})();
		</script>
	</head>
	<body>
		<!-- header -->
		<header id='pageHeader'>
			<h1>Coterie</h1>
		</header>
		<!-- main panel -->
		<div class='gainlayout' id='pageMain'>
			<!-- menu -->
			<nav data-behavior='Anchors' class='gainlayout' id='pageNav'>
				<ul>
					<li>
						<a href='welcome.html'>Welcome to Coterie</a>
						<ul>
							<li>
								<a href='test-00.html'>Test Zero</a>: AJAX Content
							</li>
							<li>
								<a href='test-01.html'>Test One</a>: AJAX Content
							</li>
						</ul>
					</li>
					<li>
						<a href='#!Modal'>Open Modal</a>
					</li>
				</ul>
			</nav>
			<!-- main content -->
			<div class='gainlayout' data-behavior='Anchors TwoPanelAJAX' id='pageMainContent'>
				<!-- main article content-->
				<article class='gainlayout' id='pageMainArticle'>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
					Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.<br/>
				</article>
				<!-- reference content -->
				<article class='gainlayout' id='pageMainExternal'></article>
				<!-- console -->
				<div class='gainlayout' data-behavior='Console' data-console-options='{"open":true}' id='pageConsole'>
					<h2>Console</h2>
				</div>
			</div>
		</div>
		<!-- footer -->
		<footer data-behavior='Copyright' id='pageFooter'>
			&copy; <span class='copyrightYear'>2011</span> Frederick J. Ostrander. All rights reserved.
		</footer>
		<!-- modal -->
		<div id='pageModal'></div>
		<table data-behavior='Modal' data-modal-options='{"margin":50}' class="modal" summary="Modal Window">
			<tbody class="modal-tbody">
	    		<tr class="modal-tr">
	    			<td class="modal-td">
	    				<div class="modal-box">
	    					<div class="modal-header"></div>
	            			<div class="modal-content">
    	          				<div class="modal-body">
        	      					<img alt="Chanel Licking Fred's Face" src="./lib/img/Chanel Licking Fred's Face 2@Pola(20110118213522).png" />
	              				</div>
            				</div>
            				<div class="modal-footer"></div>
            			</div>
	      			</td>
	    		</tr>
	    	</tbody>
		</table>
	</body>
</html>